/*
Created: 02/06/2015
Modified: 02/06/2015
Model: MySQL 5.5
Database: MySQL 5.5
*/

-- Create tables section -------------------------------------------------

-- Table Estudante

CREATE TABLE Estudante
(
  MATRICULA Int NOT NULL,
  NOME Varchar(120) NOT NULL,
  LOGIN Varchar(120) NOT NULL,
  SENHA Varchar(120) NOT NULL,
  CODIGO_CURSO Char(20) NOT NULL
)
;

ALTER TABLE Estudante ADD PRIMARY KEY (MATRICULA)
;

ALTER TABLE Estudante ADD UNIQUE LOGIN (LOGIN)
;

CREATE INDEX IX_Relationship4 ON Estudante (CODIGO_CURSO)
;

-- Table Departamento

CREATE TABLE Departamento
(
  DEPARTAMENTO_ID Int NOT NULL AUTO_INCREMENT,
  NOME Varchar(120) NOT NULL,
 PRIMARY KEY (DEPARTAMENTO_ID)
)
;

-- Table Curso

CREATE TABLE Curso
(
  CODIGO Char(20) NOT NULL,
  NOME Varchar(120) NOT NULL,
  DEPARTAMENTO_ID Int NOT NULL
)
;

ALTER TABLE Curso ADD PRIMARY KEY (CODIGO)
;

CREATE INDEX IX_Relationship5 ON Curso (DEPARTAMENTO_ID)
;

-- Table Professor

CREATE TABLE Professor
(
  PROFESSOR_ID Int NOT NULL AUTO_INCREMENT,
  NOME Varchar(120) NOT NULL,
  DEPARTAMENTO_ID Int NOT NULL,
 PRIMARY KEY (PROFESSOR_ID)
)
;

CREATE INDEX IX_Relationship2 ON Professor (DEPARTAMENTO_ID)
;

-- Table Disciplina

CREATE TABLE Disciplina
(
  CODIGO Char(20) NOT NULL,
  CH Int NOT NULL,
  VAGAS Int NOT NULL,
  LOCAL Varchar(220) NOT NULL,
  HORARIO Datetime NOT NULL,
  NOME Varchar(120) NOT NULL,
  PROFESSOR_ID Int NOT NULL,
  CODIGO_CURSO Char(20) NOT NULL
)
;

ALTER TABLE Disciplina ADD PRIMARY KEY (CODIGO)
;

CREATE INDEX IX_Relationship9 ON Disciplina (PROFESSOR_ID)
;

CREATE INDEX IX_Relationship10 ON Disciplina (CODIGO_CURSO)
;

-- Table Amizade

CREATE TABLE Amizade
(
  MATRICULA_ALUNO_1 Int NOT NULL,
  MATRICULA_ALUNO_2 Int NOT NULL
)
;

ALTER TABLE Amizade ADD PRIMARY KEY (MATRICULA_ALUNO_1,MATRICULA_ALUNO_2)
;

-- Table IntencaoMatricula

CREATE TABLE IntencaoMatricula
(
  MATRICULA Int NOT NULL,
  CODIGO Char(20) NOT NULL
)
;

ALTER TABLE IntencaoMatricula ADD PRIMARY KEY (MATRICULA,CODIGO)
;

-- Create relationships section ------------------------------------------------- 

ALTER TABLE Professor ADD CONSTRAINT FK_PROFESSOR_DEPARTAMENTO FOREIGN KEY (DEPARTAMENTO_ID) REFERENCES Departamento (DEPARTAMENTO_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE Estudante ADD CONSTRAINT FK_ESTUDANTE_CURSO FOREIGN KEY (CODIGO_CURSO) REFERENCES Curso (CODIGO) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE Curso ADD CONSTRAINT FK_CURSO_DEPARTAMENTO FOREIGN KEY (DEPARTAMENTO_ID) REFERENCES Departamento (DEPARTAMENTO_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE Disciplina ADD CONSTRAINT FK_DISCIPLINA_PROFESSOR FOREIGN KEY (PROFESSOR_ID) REFERENCES Professor (PROFESSOR_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE Disciplina ADD CONSTRAINT FK_DISCIPLINA_CURSO FOREIGN KEY (CODIGO_CURSO) REFERENCES Curso (CODIGO) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE Amizade ADD CONSTRAINT FK_ESTUDANTE1_ESTUDANTE2 FOREIGN KEY (MATRICULA_ALUNO_1) REFERENCES Estudante (MATRICULA) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE Amizade ADD CONSTRAINT FK_ESTUDANTE2_ESTUDANTE1 FOREIGN KEY (MATRICULA_ALUNO_2) REFERENCES Estudante (MATRICULA) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE IntencaoMatricula ADD CONSTRAINT FK_INTENCAOMATRICULA_ESTUDANTE FOREIGN KEY (MATRICULA) REFERENCES Estudante (MATRICULA) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE IntencaoMatricula ADD CONSTRAINT FK_INTENCAOMATRICULA_DISCIPLINA FOREIGN KEY (CODIGO) REFERENCES Disciplina (CODIGO) ON DELETE NO ACTION ON UPDATE NO ACTION
;


